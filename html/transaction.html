<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Transactions - The Miden protocol</title>


        <!-- Custom HTML head -->

        <meta name="description" content="Description and core structures for the Miden Rollup protocol">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Miden protocol</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/0xPolygonMiden/miden-base" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="transactions"><a class="header" href="#transactions">Transactions</a></h1>
<p>A <code>Transaction</code> in Miden is the state transition of a single account. A <code>Transaction</code> takes as input a single <a href="account.html">account</a> and zero or more <a href="note.html">notes</a>, and outputs the same account with an updated state, together with zero or more notes. <code>Transaction</code>s in Miden are Miden VM programs, their execution resulting in the generation of a zero-knowledge proof.</p>
<p>Miden's <code>Transaction</code> model aims for the following:</p>
<ul>
<li><strong>Parallel transaction execution</strong>: Accounts can update their state independently from each other and in parallel.</li>
<li><strong>Private transaction execution</strong>: Client-side <code>Transaction</code> proving allows the network to verify <code>Transaction</code>s validity with zero knowledge.</li>
</ul>
<p><img src="img/transaction/transaction-diagram.png" alt="Transaction diagram" /></p>
<p>Compared to most blockchains, where a <code>Transaction</code> typically involves more than one account (e.g., sender and receiver), a <code>Transaction</code> in Miden involves a single account. To illustrate, Alice sends 5 ETH to Bob. In Miden, sending 5 ETH from Alice to Bob takes two <code>Transaction</code>s, one in which Alice creates a note containing 5 ETH and one in which Bob consumes that note and receives the 5 ETH. This model removes the need for a global lock on the blockchain's state, enabling Miden to process <code>Transaction</code>s in parallel.</p>
<p>Currently the protocol limits the number of notes that can be consumed and produced in a transaction to 1000 each, which means that in a single <code>Transaction</code> an application could serve up to 2000 different user requests like deposits or withdrawals into/from a pool.</p>
<p>A simple transaction currently takes about 1-2 seconds on a MacBook Pro. It takes around <code>90K</code> cycles to create the proof, as of now the signature verification step is the dominant cost.</p>
<h2 id="transaction-lifecycle"><a class="header" href="#transaction-lifecycle">Transaction lifecycle</a></h2>
<p>Every <code>Transaction</code> describes the process of an account changing its state. This process is described as a Miden VM program, resulting in the generation of a zero-knowledge proof. <code>Transaction</code>s are being executed in a specified sequence, in which several notes and a transaction script can interact with an account.</p>
<p><img src="img/transaction/transaction-program.png" alt="Transaction execution flow" /></p>
<h3 id="inputs"><a class="header" href="#inputs">Inputs</a></h3>
<p>A <code>Transaction</code> requires several inputs:</p>
<ul>
<li><strong>Account</strong>: A <code>Transaction</code> is always executed against a single account. The executor must have complete knowledge of the account's state.</li>
<li><strong>Notes</strong>: A <code>Transaction</code> can consume and output up to <code>1024</code> notes. The executor must have complete knowledge of the note data, including note inputs, before consumption. For private notes, the data cannot be fetched from the blockchain and must be received through an off-chain channel.</li>
<li><strong>Blockchain state</strong>: The current reference block and information about the notes database used to authenticate notes to be consumed must be retrieved from the Miden operator before execution. Usually, notes to be consumed in a <code>Transaction</code> must have been created before the reference block.</li>
<li><strong>Transaction script (optional)</strong>: The <code>Transaction</code> script is code defined by the executor. And like note scripts, they can invoke account methods, e.g., sign a transaction. There is no limit to the amount of code a <code>Transaction</code> script can hold.</li>
<li><strong>Transaction arguments (optional)</strong>: For every note, the executor can inject transaction arguments that are present at runtime. If the note script — and therefore the note creator — allows, the note script can read those arguments to allow dynamic execution. See below for an example.</li>
<li><strong>Foreign account data (optional)</strong>: Any foreign account data accessed during a <code>Transaction</code>, whether private or public, must be available beforehand. There is no need to know the full account storage, but the data necessary for the <code>Transaction</code>, e.g., the key/value pair that is read and the corresponding storage root.</li>
</ul>
<h3 id="flow"><a class="header" href="#flow">Flow</a></h3>
<ol>
<li><strong>Prologue</strong>
Executes at the beginning of a transaction. It validates on-chain commitments against the provided data. This is to ensure that the transaction executes against a valid on-chain recorded state of the account and to be consumed notes. Notes to be consumed must be registered on-chain — except for <a href="note.html">erasable notes</a> which can be consumed without block inclusion.</li>
<li><strong>Note processing</strong>
Notes are executed sequentially against the account, following a sequence defined by the executor. To execute a note means processing the note script that calls methods exposed on the account interface. Notes must be consumed fully, which means that all assets must be transferred into the account or into other created notes. <a href="note.html#script">Note scripts</a> can invoke the account interface during execution. They can push assets into the account's vault, create new notes, set a transaction expiration, and read from or write to the account’s storage. Any method they call must be explicitly exposed by the account interface. Note scripts can also invoke methods of foreign accounts to read their state.</li>
<li><strong>Transaction script processing</strong>
<code>Transaction</code> scripts are an optional piece of code defined by the executor which interacts with account methods after all notes have been executed. For example, <code>Transaction</code> scripts can be used to sign the <code>Transaction</code> (e.g., sign the transaction by incrementing the nonce of the account, without which, the transaction would fail), to mint tokens from a faucet, create notes, or modify account storage. <code>Transaction</code> scripts can also invoke methods of foreign accounts to read their state.</li>
<li><strong>Epilogue</strong>
Completes the execution, resulting in an updated account state and a generated zero-knowledge proof. The validity of the resulting state change is checked. The account's <code>Nonce</code> must have been incremented, which is how the entire transaction is authenticated. Also, the net sum of all involved assets must be <code>0</code> (if the account is not a faucet).</li>
</ol>
<p>The proof together with the corresponding data needed for verification and updates of the global state can then be submitted and processed by the network.</p>
<h2 id="examples"><a class="header" href="#examples">Examples</a></h2>
<p>To illustrate the <code>Transaction</code> protocol, we provide two examples for a basic <code>Transaction</code>. We will use references to the existing Miden <code>Transaction</code> kernel — the reference implementation of the protocol — and to the methods in Miden Assembly.</p>
<h3 id="creating-a-p2id-note"><a class="header" href="#creating-a-p2id-note">Creating a P2ID note</a></h3>
<p>Let's assume account A wants to create a P2ID note. P2ID notes are pay-to-ID notes that can only be consumed by a specified target account ID. Note creators can provide the target account ID using the <a href="note.html#inputs">note inputs</a>.</p>
<p>In this example, account A uses the basic wallet and the authentication component provided by <code>miden-lib</code>. The basic wallet component defines the methods <code>wallets::basic::create_note</code> and <code>wallets::basic::move_asset_to_note</code> to create notes with assets, and <code>wallets::basic::receive_asset</code> to receive assets. The authentication component exposes <code>auth::basic::auth_tx_rpo_falcon512</code> which allows for signing a transaction. Some account methods like <code>account::get_id</code> are always exposed.</p>
<p>The executor inputs to the Miden VM a <code>Transaction</code> script in which he places on the stack the data (tag, aux, note_type, execution_hint, RECIPIENT) of the note(s) that he wants to create using <code>wallets::basic::create_note</code> during the said <code>Transaction</code>. The <a href="https://github.com/0xPolygonMiden/miden-base/blob/main/crates/miden-objects/src/note/recipient.rs"><code>NoteRecipient</code></a> is a value that describes under which condition a note can be consumed and is built using a <code>serial_number</code>, the <code>note_script</code> (in this case P2ID script) and the <code>note_inputs</code>. The Miden VM will execute the <code>Transaction</code> script and create the note(s). After having been created, the executor can use <code>wallets::basic::move_asset_to_note</code> to move assets from the account's vault to the notes vault.</p>
<p>After finalizing the <code>Transaction</code> the updated state and created note(s) can now be submitted to the Miden operator to be recorded on-chain.</p>
<h3 id="consuming-a-p2id-note"><a class="header" href="#consuming-a-p2id-note">Consuming a P2ID note</a></h3>
<p>Let's now assume that account A wants to consume a P2ID note to receive the assets contained in that note.</p>
<p>To start the transaction process, the executor fetches and prepares all the input data to the <code>Transaction</code>. First, it retrieves blockchain data, like global inputs and block data of the most recent block. This information is needed to authenticate the native account's state and that the P2ID note exists on-chain. Then it loads the full account and note data, to start the <code>Transaction</code> execution.</p>
<p>In the transaction's prologue the data is being authenticated by re-hashing the provided values and comparing them to the blockchain's data (this is how private data can be used and verified during the execution of transaction without actually revealing it to the network).</p>
<p>Then the P2ID note script is being executed. The script starts by reading the note inputs <code>note::get_inputs</code> — in our case the account ID of the intended target account. It checks if the provided target account ID equals the account ID of the executing account. This is the first time the note invokes a method exposed by the <code>Transaction</code> kernel, <code>account::get_id</code>.</p>
<p>If the check passes, the note script pushes the assets it holds into the account's vault. For every asset the note contains, the script calls the <code>wallets::basic::receive_asset</code> method exposed by the account's wallet component. The <code>wallets::basic::receive_asset</code> procedure calls <code>account::add_asset</code>, which cannot be called from the note itself. This allows accounts to control what functionality to expose, e.g. whether the account supports receiving assets or not, and the note cannot bypass that.</p>
<p>After the assets are stored in the account's vault, the transaction script is being executed. The script calls <code>auth::basic::auth_tx_rpo_falcon512</code> which is explicitly exposed in the account interface. The method is used to verify a provided signature against a public key stored in the account's storage and a commitment to this specific transaction. If the signature can be verified, the method increments the nonce.</p>
<p>The Epilogue finalizes the transaction by computing the final account hash, asserting the nonce increment and checking that no assets were created or destroyed in the transaction — that means the net sum of all assets must stay the same.</p>
<h2 id="transaction-types"><a class="header" href="#transaction-types">Transaction types</a></h2>
<p>There are two types of <code>Transaction</code>s in Miden: <strong>local transactions</strong> and <strong>network transactions</strong> [not yet implemented].</p>
<h3 id="local-transaction"><a class="header" href="#local-transaction">Local transaction</a></h3>
<p>Users transition their account's state locally using the Miden VM and generate a <code>Transaction</code> proof that can be verified by the network, which we call <strong>client-side proving</strong>. The network then only has to verify the proof and to change the global parts of the state to apply the state transition.</p>
<p>They are useful, because:</p>
<ol>
<li>They enable privacy as neither the account state nor account code are needed to verify the zero-knowledge proof. Public inputs are only commitments and block information that are stored on-chain.</li>
<li>They are cheaper (i.e., lower in fees) as the execution of the state transition and the generation of the zero-knowledge proof are already made by the users. Hence <strong>privacy is the cheaper option on Miden</strong>.</li>
<li>They allow arbitrarily complex computation to be done. The proof size doesn't grow linearly with the complexity of the computation. Hence there is no gas limit for client-side proving.</li>
</ol>
<p>Client-side proving or local transactions on low-power devices can be slow, but Miden offers a pragmatic alternative: <strong>delegated proving</strong>. Instead of waiting for complex computations to finish on your device, you can hand off proof generation to a service, ensuring a consistent 1-2 second proving time, even on mobile.</p>
<h3 id="network-transaction"><a class="header" href="#network-transaction">Network transaction</a></h3>
<p>The Miden operator executes the <code>Transaction</code> and generates the proof. Miden uses network <code>Transaction</code>s for smart contracts with public shared state. This type of <code>Transaction</code> is quite similar to the ones in traditional blockchains (e.g., Ethereum).</p>
<p>They are useful, because:</p>
<ol>
<li>For public shared state of smart contracts. Network <code>Transaction</code>s allow orchestrated state changes of public smart contracts without race conditions.</li>
<li>Smart contracts should be able to be executed autonomously, ensuring liveness. Local <code>Transaction</code>s require a user to execute and prove, but in some cases a smart contract should be able to execute when certain conditions are met.</li>
<li>Clients may not have sufficient resources to generate zero-knowledge proofs.</li>
</ol>
<p>The ability to facilitate both, local and network <code>Transaction</code>s, <strong>is one of the differentiating factors of Miden</strong> compared to other blockchains. Local <code>Transaction</code> execution and proving can happen in parallel as for most <code>Transaction</code>s there is no need for public state changes. This increases the network's throughput tremendously and provides privacy. Network <code>Transaction</code>s on the other hand enable autonomous smart contracts and public shared state.</p>
<hr />
<blockquote>
<p><strong>Good to know</strong></p>
<ul>
<li>
<p>Usually, notes that are consumed in a <code>Transaction</code> must be recorded on-chain in order for the <code>Transaction</code> to succeed. However, Miden supports <strong>erasable notes</strong> which are notes that can be consumed in a <code>Transaction</code> before being registered on-chain. For example, one can build a sub-second order book by allowing its traders to build faster transactions that depend on each other and are being validated or erased in batches.</p>
</li>
<li>
<p>There is no nullifier check during a <code>Transaction</code>. Nullifiers are checked by the Miden operator during <code>Transaction</code> verification. So at the local level, there is "double spending." If a note was already spent, i.e. there exists a nullifier for that note, the block producer would never include the <code>Transaction</code> as it would make the block invalid.</p>
</li>
<li>
<p>One of the main reasons for separating execution and proving steps is to allow <em>stateless provers</em>; i.e., the executed <code>Transaction</code> has all the data it needs to re-execute and prove a <code>Transaction</code> without database access. This supports easier proof-generation distribution.</p>
</li>
<li>
<p>Not all <code>Transaction</code>s require notes. For example, the owner of a faucet can mint new tokens using only a <code>Transaction</code> script, without interacting with external notes.</p>
</li>
<li>
<p>In Miden executors can choose arbitrary reference blocks to execute against their state. Hence it is possible to set <code>Transaction</code> expiration heights and in doing so, to define a block height until a <code>Transaction</code> should be included into a block. If the <code>Transaction</code> is expired, the resulting account state change is not valid and the <code>Transaction</code> cannot be verified anymore.</p>
</li>
<li>
<p>Note and <code>Transaction</code> scripts can read the state of foreign accounts during execution. This is called foreign procedure invocation. For example, the price of an asset for the <strong>Swap</strong> script might depend on a certain value stored in the oracle account.</p>
</li>
<li>
<p>An example of the right usage of <code>Transaction</code> arguments is the consumption of a <strong>Swap</strong> note. Those notes allow asset exchange based on predefined conditions. Example:</p>
<ul>
<li>The note's consumption condition is defined as "anyone can consume this note to take <code>X</code> units of asset A if they simultaneously create a note sending Y units of asset B back to the creator." If an executor wants to buy only a fraction <code>(X-m)</code> of asset A, they provide this amount via transaction arguments. The executor would provide the value <code>m</code>. The note script then enforces the correct transfer:
<ul>
<li>A new note is created returning <code>Y-((m*Y)/X)</code> of asset B to the sender.</li>
<li>A second note is created, holding the remaining <code>(X-m)</code> of asset A for future consumption.</li>
</ul>
</li>
</ul>
</li>
<li>
<p>When executing a <code>Transaction</code> the max number of VM cycles is <strong><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">30</span></span></span></span></span></span></span></span></span></span></span></span></strong>.</p>
</li>
</ul>
</blockquote>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="asset.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="state.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="asset.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="state.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
